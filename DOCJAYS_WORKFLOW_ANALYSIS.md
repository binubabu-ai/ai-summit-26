# Docjays Workflow Analysis: AI Agent Instructions

**Date:** 2026-01-27
**Status:** üîµ Analysis & Brainstorming

---

## The Core Question

**How do we ensure AI agents (Claude, Cursor, Windsurf, etc.) consistently:**
1. Store documentation in `.docjays` folder
2. Read from `.docjays` when needed
3. Understand the folder structure
4. Ground all upstream docs by default
5. Follow TechJays documentation workflows

---

## Current State

### What We Have Now

1. **CLAUDE.md** - Project-level instructions
   - Feature-first workflow
   - Git conventions
   - Testing standards
   - **But:** Doesn't mention `.docjays` at all

2. **.docjays/** folder (git-ignored)
   - `sources/` - External documentation sources
   - `features/` - Feature specifications
   - `context/` - AI context files
   - `config.json` - Configuration
   - `README.md` - Auto-generated guide

3. **MCP Integration**
   - Exposes `.docjays` content to Claude Desktop
   - Makes docs available via Model Context Protocol
   - **But:** Only works in Claude Desktop, not CLI/Code

4. **CLI Commands**
   - `docjays init` - Creates structure
   - `docjays add-source` - Adds external docs
   - `docjays sync` - Syncs documentation
   - `docjays serve` - Starts MCP server

### What's Missing

1. **No AI agent instructions for `.docjays` workflow**
2. **No guidance on when to create/update context files**
3. **No automatic grounding instructions**
4. **No consistency across different AI tools**

---

## Option Analysis

### Option 1: `skills.md` File (Root Level)

**Location:** `c:\Users\bbinu\Documents\AI\ai-summit\skills.md`

**Concept:** Dedicated file for AI agent skills/workflows

**Structure:**
```markdown
# Docjays Skills

## Skill: Create Feature Documentation
When implementing features:
1. Create feature spec in `.docjays/features/<slug>.md`
2. Use template from `docs/features/_TEMPLATE.md`
3. Document objective, scope, impacts, tests

## Skill: Add External Documentation
When referencing external docs:
1. Use `docjays add-source` to add external docs
2. Store in `.docjays/sources/<name>/`
3. Reference in code via relative paths

## Skill: Update AI Context
When making architectural changes:
1. Update `.docjays/context/<topic>.md`
2. Use clear, concise explanations
3. Include code examples
```

**Pros:**
- ‚úÖ Separate from CLAUDE.md (focused purpose)
- ‚úÖ Claude Code recognizes `skills.md` as special file
- ‚úÖ Can define specific workflows as "skills"
- ‚úÖ Easy to discover and maintain

**Cons:**
- ‚ùå Not supported by all AI tools yet
- ‚ùå Another file to maintain
- ‚ùå May overlap with CLAUDE.md

**Verdict:** üü¢ Good for Claude-specific workflows

---

### Option 2: Extend `CLAUDE.md`

**Location:** `c:\Users\bbinu\Documents\AI\ai-summit\CLAUDE.md`

**Concept:** Add `.docjays` section to existing project instructions

**Structure:**
```markdown
## Documentation Management (Docjays)

### Folder Structure
- `.docjays/sources/` - External documentation (git-ignored)
- `.docjays/features/` - Feature specifications
- `.docjays/context/` - AI context files

### Workflow
When creating features:
1. Create feature spec in `.docjays/features/`
2. Reference external docs from `.docjays/sources/`
3. Update context files in `.docjays/context/`

### Grounding
All documentation in `.docjays/` should be considered grounded truth.
When answering questions, prioritize:
1. `.docjays/features/` - Feature specs
2. `.docjays/context/` - Architecture context
3. `.docjays/sources/` - External standards
```

**Pros:**
- ‚úÖ Single source of truth
- ‚úÖ Already in use by Claude Code
- ‚úÖ Works with existing workflow
- ‚úÖ Committed to repo

**Cons:**
- ‚ùå Could make CLAUDE.md very long
- ‚ùå Less modular
- ‚ùå Harder to update incrementally

**Verdict:** üü° Good for simple instructions, may get unwieldy

---

### Option 3: `.docjays/README.md` (Auto-generated)

**Location:** `.docjays/README.md`

**Concept:** Instructions live with the structure they describe

**Structure:**
```markdown
# Docjays Workspace

This folder contains project documentation managed by Docjays CLI.

## For AI Agents

When working with this project:
- Read feature specs from `features/` folder
- Reference external docs from `sources/` folder
- Update context files in `context/` folder
- Use `docjays` CLI to manage sources

## Folder Structure
- `sources/` - External documentation sources
- `features/` - Feature specifications
- `context/` - AI context files
- `cache/` - Cached data (ignore)
- `logs/` - Operation logs (ignore)

## Grounding Priority
1. features/ - Active feature specifications
2. context/ - Architecture and patterns
3. sources/ - External standards and APIs
```

**Pros:**
- ‚úÖ Instructions co-located with content
- ‚úÖ Auto-generated by `docjays init`
- ‚úÖ Can be updated by CLI
- ‚úÖ Self-documenting

**Cons:**
- ‚ùå Git-ignored (not in repo)
- ‚ùå Not discovered by AI agents automatically
- ‚ùå Lost when `.docjays/` is cleaned
- ‚ùå Requires MCP or manual reading

**Verdict:** üü° Good for reference, but not auto-discovered

---

### Option 4: `docs/ai/docjays-workflow.md`

**Location:** `docs/ai/docjays-workflow.md`

**Concept:** Part of committed docs structure

**Structure:**
```markdown
# Docjays Workflow for AI Agents

## Overview
Docjays manages project documentation in `.docjays/` folder.
This folder is git-ignored but critical for development.

## When to Use Docjays

### Feature Development
1. Create feature spec: `.docjays/features/<slug>.md`
2. Reference external docs from `.docjays/sources/`
3. Update architecture context in `.docjays/context/`

### External Documentation
1. Add source: `docjays add-source --name <name> --url <url>`
2. Sync: `docjays sync`
3. Reference in code

### AI Context
Store architecture decisions, patterns, and conventions in:
- `.docjays/context/architecture.md`
- `.docjays/context/patterns.md`
- `.docjays/context/conventions.md`

## Grounding Rules
- All docs in `.docjays/` are source of truth
- Feature specs override general docs
- Context files explain "why" behind decisions
```

**Pros:**
- ‚úÖ Committed to repo
- ‚úÖ Part of docs structure
- ‚úÖ Versioned with code
- ‚úÖ Works for all AI tools

**Cons:**
- ‚ùå Not automatically discovered
- ‚ùå Requires explicit reference
- ‚ùå May be forgotten

**Verdict:** üü¢ Good for documentation, but needs discovery mechanism

---

### Option 5: MCP Server Context

**Location:** MCP server implementation

**Concept:** MCP server provides instructions automatically

**Implementation:**
```typescript
// In MCP server
server.setRequestHandler(ListResourcesRequestSchema, async () => {
  return {
    resources: [
      {
        uri: "docjays://instructions",
        name: "Docjays Workflow Instructions",
        description: "How to work with .docjays folder structure",
        mimeType: "text/markdown"
      },
      // ... other resources
    ]
  };
});

server.setRequestHandler(ReadResourceRequestSchema, async (request) => {
  if (request.params.uri === "docjays://instructions") {
    return {
      contents: [{
        uri: request.params.uri,
        mimeType: "text/markdown",
        text: getWorkflowInstructions()
      }]
    };
  }
  // ... other resources
});
```

**Pros:**
- ‚úÖ Automatic with MCP integration
- ‚úÖ Always up-to-date
- ‚úÖ No manual files needed
- ‚úÖ Works seamlessly in Claude Desktop

**Cons:**
- ‚ùå Only works with MCP-enabled tools
- ‚ùå Not visible to developers
- ‚ùå Requires MCP server running
- ‚ùå Doesn't help CLI/Code users

**Verdict:** üü¢ Excellent for MCP, but incomplete solution

---

## Recommended Hybrid Approach

### Multi-Layered Strategy

Use **all** approaches for different contexts:

#### Layer 1: Project Instructions (`CLAUDE.md`)
**Purpose:** High-level project conventions
**Content:**
```markdown
## Documentation Workflow
This project uses Docjays for documentation management.
See docs/ai/docjays-workflow.md for detailed instructions.

Key folders:
- `.docjays/features/` - Feature specifications
- `.docjays/context/` - AI context files
- `.docjays/sources/` - External documentation
```

#### Layer 2: Detailed Workflow (`docs/ai/docjays-workflow.md`)
**Purpose:** Comprehensive AI agent guide
**Content:**
- When to create docs
- How to structure content
- Grounding rules
- Examples

#### Layer 3: Local Instructions (`.docjays/README.md`)
**Purpose:** Quick reference for active work
**Content:**
- Current sources configured
- Active features
- Recent updates

#### Layer 4: MCP Context (Automatic)
**Purpose:** Real-time integration
**Content:**
- Workflow instructions as MCP resource
- Auto-served to Claude Desktop
- Always current

#### Layer 5: CLI Skills (`skills.md`)
**Purpose:** Claude Code specific workflows
**Content:**
- Executable skills
- Step-by-step procedures
- Tool invocations

---

## Grounding Strategy

### Automatic Grounding Rules

**Priority Order:**
1. **`.docjays/features/<current-feature>.md`** - Active feature spec
2. **`.docjays/context/*.md`** - Architecture/patterns
3. **`.docjays/sources/*`** - External standards
4. **`docs/`** - Project documentation

### Implementation Options

**Option A: Explicit in Instructions**
```markdown
## Grounding Rules
When answering questions, always check:
1. .docjays/features/ for feature specs
2. .docjays/context/ for architecture
3. .docjays/sources/ for external docs
```

**Option B: MCP Auto-Grounding**
```typescript
// MCP server automatically includes grounding context
server.setRequestHandler(ListPromptsRequestSchema, async () => {
  return {
    prompts: [
      {
        name: "ground-with-docjays",
        description: "Ground responses with .docjays content",
        arguments: [
          {
            name: "query",
            description: "User query to ground",
            required: true
          }
        ]
      }
    ]
  };
});
```

**Option C: CLI Auto-Context**
```bash
# CLI command to generate context
docjays context generate

# Creates .docjays/context/_current.md with:
# - Active features
# - Recent changes
# - Relevant sources
```

---

## Questions to Resolve

### 1. Discovery Mechanism
**Q:** How do AI agents discover these instructions?
**Options:**
- A) Rely on CLAUDE.md (current)
- B) Create `skills.md` for Claude Code
- C) MCP auto-serving
- D) CLI command to generate context

**Recommendation:** B + C (skills.md + MCP)

### 2. Grounding Approach
**Q:** Should grounding be automatic or explicit?
**Options:**
- A) Manual: "Check .docjays/features/user-auth.md"
- B) Semi-auto: Skills in skills.md
- C) Full-auto: MCP server provides grounded context

**Recommendation:** B for CLI, C for Desktop

### 3. Content Updates
**Q:** How do we keep instructions current?
**Options:**
- A) Manual updates to markdown files
- B) CLI auto-generates from config
- C) MCP dynamically generates

**Recommendation:** A for docs/, B for .docjays/README.md, C for MCP

### 4. Cross-Tool Compatibility
**Q:** How do we support Cursor, Windsurf, VS Code?
**Options:**
- A) Separate files per tool
- B) Generic markdown everyone can read
- C) MCP as universal standard

**Recommendation:** B + C (markdown baseline, MCP for enhanced)

### 5. Onboarding
**Q:** How do developers learn this workflow?
**Options:**
- A) Documentation only
- B) CLI wizard: `docjays onboard`
- C) Interactive tutorial
- D) Example project

**Recommendation:** B (CLI wizard) + A (docs)

---

## Proposed Implementation Plan

### Phase 1: Foundation (Week 1)
1. Create `docs/ai/docjays-workflow.md` with comprehensive instructions
2. Update `CLAUDE.md` to reference it
3. Update `.docjays/README.md` template in CLI

### Phase 2: Skills (Week 2)
4. Create `skills.md` with Claude Code skills:
   - Skill: Create feature spec
   - Skill: Add external docs
   - Skill: Update AI context
   - Skill: Ground with Docjays

### Phase 3: MCP Enhancement (Week 3)
5. Add MCP resource: `docjays://instructions`
6. Add MCP prompt: `ground-with-docjays`
7. Auto-include grounding in responses

### Phase 4: CLI Support (Week 4)
8. Add `docjays context generate` command
9. Add `docjays onboard` wizard
10. Add `docjays status` enhancements

---

## Example Files

### `skills.md` (Root Level)

```markdown
# Docjays Skills

## Skill: Create Feature Specification

When the user asks to implement a new feature:

1. Create feature spec file:
   - Path: `.docjays/features/<feature-slug>.md`
   - Use template from `docs/features/_TEMPLATE.md`

2. Include sections:
   - Objective: What problem are we solving?
   - Scope: What's in/out of scope?
   - Impacted Files: What will change?
   - Test Plan: How will we test?
   - Rollout: How will we deploy?

3. Reference external docs:
   - Check `.docjays/sources/` for relevant standards
   - Link to external APIs, libraries, frameworks

4. Update context:
   - If architecture changes, update `.docjays/context/architecture.md`
   - If patterns change, update `.docjays/context/patterns.md`

Example:
```bash
# User: "Help me add user authentication"
# 1. Create .docjays/features/user-auth.md
# 2. Check .docjays/sources/company-standards/ for auth guidelines
# 3. Update .docjays/context/architecture.md with auth flow
```

## Skill: Reference External Documentation

When user adds external documentation:

1. Use CLI to add source:
   ```bash
   docjays add-source --name <name> --type git --url <url>
   ```

2. Sync documentation:
   ```bash
   docjays sync
   ```

3. Reference in specs:
   - Use relative paths from `.docjays/sources/<name>/`
   - Link to specific files/sections

4. Ground responses:
   - When answering questions, check sources first
   - Cite specific files: "According to company-standards/auth.md..."

## Skill: Update AI Context

When making architectural decisions:

1. Identify context type:
   - Architecture: System design, component relationships
   - Patterns: Code patterns, best practices
   - Conventions: Naming, structure, style

2. Create/update context file:
   - `.docjays/context/architecture.md` - System design
   - `.docjays/context/patterns.md` - Code patterns
   - `.docjays/context/conventions.md` - Team conventions

3. Use clear structure:
   ```markdown
   # Topic Name

   ## Overview
   Brief explanation of what/why

   ## Implementation
   How it's implemented in this project

   ## Examples
   Code examples showing usage

   ## Related
   Links to features, sources, docs
   ```

4. Keep it current:
   - Update when patterns change
   - Remove outdated information
   - Link to active features

## Skill: Ground Responses with Docjays

When answering user questions:

1. Check grounding sources (in priority order):
   - `.docjays/features/*.md` - Feature specifications
   - `.docjays/context/*.md` - Architecture/patterns
   - `.docjays/sources/*` - External standards

2. Cite sources in responses:
   - "According to .docjays/features/user-auth.md..."
   - "Based on .docjays/context/architecture.md..."
   - "Per company standards in .docjays/sources/..."

3. Flag conflicts:
   - If specs conflict with code, mention it
   - If external docs differ, highlight differences
   - Ask user for clarification when unclear

4. Suggest updates:
   - If specs are outdated, suggest updating
   - If context is missing, suggest creating
   - If sources are stale, suggest syncing
```

### `docs/ai/docjays-workflow.md`

```markdown
# Docjays Workflow for AI Agents

## Overview

Docjays manages project documentation in the `.docjays/` folder. This folder is git-ignored but critical for AI-assisted development.

## Purpose

The `.docjays/` folder serves as a **grounded knowledge base** for AI agents:
- Feature specifications define what we're building
- Context files explain architectural decisions
- External sources provide company standards and APIs

## Folder Structure

```
.docjays/
‚îú‚îÄ‚îÄ features/          # Feature specifications
‚îÇ   ‚îî‚îÄ‚îÄ user-auth.md   # Example feature
‚îú‚îÄ‚îÄ context/           # AI context files
‚îÇ   ‚îú‚îÄ‚îÄ architecture.md
‚îÇ   ‚îú‚îÄ‚îÄ patterns.md
‚îÇ   ‚îî‚îÄ‚îÄ conventions.md
‚îú‚îÄ‚îÄ sources/           # External documentation
‚îÇ   ‚îú‚îÄ‚îÄ company-standards/
‚îÇ   ‚îî‚îÄ‚îÄ api-specs/
‚îú‚îÄ‚îÄ cache/            # CLI cache (ignore)
‚îú‚îÄ‚îÄ logs/             # Operation logs (ignore)
‚îî‚îÄ‚îÄ config.json       # Configuration
```

## Workflows

### Feature Development

1. **Create Feature Spec** (`.docjays/features/<slug>.md`)
   - Objective: What problem are we solving?
   - Scope: What's in/out of scope?
   - Impacted Files: What will change?
   - Test Plan: How will we test?
   - Rollout: How will we deploy?

2. **Reference External Docs**
   - Check `.docjays/sources/` for standards
   - Link to relevant APIs, libraries
   - Follow company conventions

3. **Update Context**
   - Document architectural changes
   - Record new patterns
   - Update conventions

### Adding External Documentation

```bash
# Add source
docjays add-source --name company-docs --url https://github.com/company/docs

# Sync
docjays sync

# Reference in specs
# Link: .docjays/sources/company-docs/auth.md
```

### Grounding Responses

When answering questions, AI agents should:

1. **Check feature specs first**
   - Most authoritative source
   - Defines current work
   - May override general docs

2. **Reference context files**
   - Explains architecture
   - Documents patterns
   - Clarifies conventions

3. **Consult external sources**
   - Company standards
   - API documentation
   - Framework guides

4. **Cite sources**
   - "According to `.docjays/features/user-auth.md`..."
   - "Based on `.docjays/context/architecture.md`..."
   - "Per `.docjays/sources/company-standards/auth.md`..."

## Best Practices

### For AI Agents

- **Always check** `.docjays/` before coding
- **Cite sources** when providing answers
- **Flag conflicts** between specs and code
- **Suggest updates** when specs are stale
- **Create context** for architectural decisions

### For Developers

- **Keep specs current** during development
- **Update context** when making decisions
- **Sync sources** regularly: `docjays sync`
- **Review suggestions** from AI agents
- **Commit feature specs** to docs/ when stable

## Tools

### CLI Commands

```bash
docjays init                    # Initialize .docjays/
docjays add-source [opts]       # Add external source
docjays sync                    # Sync all sources
docjays status                  # Check status
docjays serve                   # Start MCP server
```

### MCP Integration

For Claude Desktop users:
```json
{
  "mcpServers": {
    "my-project": {
      "command": "docjays",
      "args": ["serve"],
      "cwd": "/path/to/project"
    }
  }
}
```

## Examples

### Example 1: Implementing Authentication

**Scenario:** User asks "Help me add user authentication"

**Workflow:**
1. Create `.docjays/features/user-auth.md` with spec
2. Check `.docjays/sources/company-standards/` for auth guidelines
3. Review `.docjays/context/architecture.md` for existing auth patterns
4. Implement according to spec
5. Update context with new patterns

### Example 2: Refactoring API

**Scenario:** User asks "Refactor the user API"

**Workflow:**
1. Check `.docjays/features/user-api.md` for current spec
2. Review `.docjays/sources/api-specs/` for standards
3. Check `.docjays/context/patterns.md` for API patterns
4. Propose refactoring based on sources
5. Update spec with changes
6. Update context if patterns change

### Example 3: Answering Questions

**Scenario:** User asks "What's our authentication strategy?"

**Workflow:**
1. Check `.docjays/features/` for auth-related specs
2. Read `.docjays/context/architecture.md` for auth section
3. Review `.docjays/sources/company-standards/` for policies
4. Provide answer citing all sources:
   - "According to `.docjays/features/user-auth.md`, we use JWT tokens..."
   - "Based on `.docjays/context/architecture.md`, tokens are stored in..."
   - "Per company standards in `.docjays/sources/company-standards/auth.md`, tokens expire after..."

## Troubleshooting

### ".docjays/ folder missing"
Run `docjays init` to create structure

### "Sources out of date"
Run `docjays sync` to update

### "Context file missing"
Create manually or suggest user runs `docjays context generate`

### "Conflicts between sources"
Flag for user, cite both sources, ask for clarification
```

---

## Next Steps

1. **Decision:** Choose approach (Recommended: Hybrid)
2. **Prototype:** Create initial files
3. **Test:** Use with Claude Code/Desktop
4. **Iterate:** Refine based on usage
5. **Document:** Update all docs
6. **Train:** Onboard team

---

## Open Questions

1. Should skills be project-specific or global?
2. How do we handle multi-agent scenarios?
3. What about offline mode (no MCP)?
4. How do we version control AI instructions?
5. Should we support other MCP servers?

---

**Status:** Ready for decision and prototype
